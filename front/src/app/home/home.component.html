<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3>Bonjour : {{user?.nom}} {{user?.prenom}}</h3>
    <div>
      <button class="btn btn-outline-danger me-2" (click)="logout()">
        <i class="bi bi-box-arrow-right"></i> Logout
      </button>
      <button class="btn btn-primary" (click)="addcontact()">
        <i class="bi bi-plus-circle"></i> Add Contact
      </button>
      <button class="btn btn-success" (click)="toggleCategoryForm()">
        <i class="bi bi-tag"></i> {{ showCategoryForm ? 'Cancel' : 'New Category' }}
      </button>
    </div>

    <div *ngIf="showCategoryForm" class="card my-3">
      <div class="card-body">
        <h5 class="card-title">Create New Category</h5>
        <div class="mb-3">
          <label for="categoryName" class="form-label">Name*</label>
          <input type="text"
                 class="form-control"
                 id="categoryName"
                 [(ngModel)]="newCategory.nom"
                 placeholder="Category name"
                 required>
        </div>
        <div class="mb-3">
          <label for="categoryDesc" class="form-label">Description</label>
          <textarea class="form-control"
                    id="categoryDesc"
                    [(ngModel)]="newCategory.description"
                    rows="2"
                    placeholder="Optional description"></textarea>
        </div>
        <div class="d-flex justify-content-end">
          <button class="btn btn-outline-secondary me-2" (click)="showCategoryForm = false">
            Cancel
          </button>
          <button class="btn btn-primary"
                  (click)="createCategory()"
                  [disabled]="!newCategory.nom">
            <i class="bi bi-check-circle"></i> Create Category
          </button>
        </div>
      </div>
    </div>

  </div>

  <div *ngIf="message" class="alert alert-info">{{message}}</div>

  <h2 class="mb-3">Client List</h2>

  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead class="table-dark">
      <tr>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Email</th>
        <th>Categories</th>
        <th>Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let client of contacts">
        <td>{{client.firstName}}</td>
        <td>{{client.lastName}}</td>
        <td>{{client.email}}</td>
        <td>
            <span *ngFor="let category of client.categories" class="badge bg-secondary me-1">
              {{category.nom}}
            </span>
        </td>
        <td>
          <button class="btn btn-sm btn-warning me-2" (click)="updatecontact(client)">
            <i class="bi bi-pencil"></i> Edit
          </button>
          <button class="btn btn-sm btn-danger" (click)="deletecontact(client)">
            <i class="bi bi-trash"></i> Delete
          </button>

        </td>
      </tr>
      <tr *ngIf="contacts.length === 0">
        <td colspan="5" class="text-center text-muted py-4">
          Aucun contact trouv√©
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
